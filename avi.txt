import java.sql.*;
import java.io.*;
import java.net.*;

public class OracleSQLProxy {
    private static final String ORACLE_DB_URL = "jdbc:oracle:thin:@your_remote_db:1521/your_db";
    private static final String ORACLE_USER = "your_user";
    private static final String ORACLE_PASS = "your_password";
    private static final int PROXY_PORT = 3307; // Custom proxy port

    public static void main(String[] args) {
        try (ServerSocket serverSocket = new ServerSocket(PROXY_PORT)) {
            System.out.println("SQL Proxy running on port " + PROXY_PORT);
            while (true) {
                Socket clientSocket = serverSocket.accept();
                new Thread(() -> handleClient(clientSocket)).start();
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private static void handleClient(Socket clientSocket) {
        try (Connection conn = DriverManager.getConnection(ORACLE_DB_URL, ORACLE_USER, ORACLE_PASS);
             BufferedReader in = new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));
             PrintWriter out = new PrintWriter(clientSocket.getOutputStream(), true)) {

            String sqlQuery = in.readLine();
            try (Statement stmt = conn.createStatement();
                 ResultSet rs = stmt.executeQuery(sqlQuery)) {

                StringBuilder response = new StringBuilder();
                while (rs.next()) {
                    response.append(rs.getString(1)).append("\n");
                }
                out.println(response.toString());
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
